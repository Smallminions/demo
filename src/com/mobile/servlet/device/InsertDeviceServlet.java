package com.mobile.servlet.device;import com.mobile.model.Device;import com.mobile.model.Ed;import com.mobile.util.DaoFactory;import javax.servlet.ServletException;import javax.servlet.annotation.WebServlet;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;@WebServlet(name = "InsertDeviceServlet", urlPatterns = {"/InsertDeviceServlet"})public class InsertDeviceServlet extends HttpServlet {    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {        dosomething(request,response);    }    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {        dosomething(request,response);    }    protected void dosomething(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {        request.setCharacterEncoding("UTF-8");        response.setCharacterEncoding("UTF-8");        String eid = request.getParameter("eid");        String did = request.getParameter("deviceid");        String dname = request.getParameter("devicekind");        String dplace = request.getParameter("devicearea");        String dstatus = request.getParameter("using");        Device device = new Device();        device.setDid(did);        device.setDname(dname);        device.setDplace(dplace);        if(eid.equals("")){ //插入一个未使用的设备信息            device.setDstatus(false);            if(!DaoFactory.getDeviceDao().insertDevice(device)){                request.setAttribute("point", "对不起,设备添加失败！！！");                request.getRequestDispatcher("/point.jsp").forward(request, response);            }else{                request.getRequestDispatcher("/device.jsp").forward(request, response);            }        }else{ //插入已经在使用的设备信息            device.setDstatus(true);            if(!DaoFactory.getDeviceDao().insertDevice(device)){                request.setAttribute("point", "对不起,设备添加失败！！！");                request.getRequestDispatcher("/point.jsp").forward(request, response);            }else{                Ed ed = new Ed();                ed.setEid(eid);                ed.setDid(did);                if(!DaoFactory.getEdDao().insertEd(ed)){                    request.setAttribute("point", "对不起,用户申请设备失败！！！");                    request.getRequestDispatcher("/point.jsp").forward(request, response);                }                request.getRequestDispatcher("/device.jsp").forward(request, response);            }        }    }}